---
title: "HW13: Strings and things"
author: "Amanda Russom"
date: "`r format(Sys.time(), '%d %B %Y')`"
output: html_notebook
editor_options:
  chunk_output_type: inline
---

```{r}
library(tidyverse)
library(here)
library(ggthemes)
```

### Import beta_gliadin data
```{r}
beta_gliadin_raw <- read_lines(here("Data", "beta_gliadin.txt"),skip = 1)
beta_gliadin_raw
```

### replace whitespace and digits with nothing
```{r}
beta_gliadin_cleaned <- str_replace_all(beta_gliadin_raw,"\\d","") %>% 
  str_replace_all("\\s", "")
beta_gliadin_cleaned
  
```
### Collapse the strings
```{r}
beta_gliadin_collapsed <- str_c(beta_gliadin_cleaned, collapse = "")
beta_gliadin_collapsed
```

### Convert to upper case and return length
```{r}
beta_g_upper <- str_to_upper(beta_gliadin_collapsed) 
beta_g_upper
```
### find length of sequence
```{r}
str_length(beta_g_upper)
```


### count the letters that are not A, C, G, T
```{r}
str_count(beta_g_upper, ".A.C.G.T.")
```
### Count start codons 
```{r}
str_count(beta_g_upper, "ATG")
```
### Count stop codons
```{r}
str_count(beta_g_upper, "TGA|TAA")
```
### create caat_box and tata_box variables
```{r}
caat_box <- "CCAAT"
tata_box <- "CTATAA"

```
### count how many times caat_box occurs in the DNA sequence
```{r}
str_count(beta_g_upper, caat_box)
```
### count how many times tata_box occurs in the DNA sequence
```{r}
str_count(beta_g_upper, tata_box)
```
### create caat_seq search string

```{r}
caat_seq <- "CCAAT.{100,150}ATG"
```
### Count how many times this sequence occurs
```{r}
str_count(beta_g_upper, caat_seq)
```

### Create tata_seq search string
```{r}
tata_seq <- "CTATAA.{50,100}ATG"
```
### Count how many times this sequence occurs
```{r}
str_count(beta_g_upper, tata_seq)
```
### extract all caat_seq, determine the length of each sequence
```{r}
caat_seq_all <- str_extract_all(beta_g_upper, caat_seq, simplify = TRUE)
str_length(caat_seq_all)
```
### use str_which() 
```{r}
str_which(caat_seq_all, tata_seq)

```
### str_which() would only show the postion of the match, not the match itself

### use str_subset() to print the entire match
```{r}
promotor <- str_subset(caat_seq_all, tata_seq)
promotor
```
### determine the length of the match
```{r}
str_length(promotor)
```
### Part 2: Ants

### Import ants data
```{r}
ants_raw <- read_csv(here("Data", "ants.csv"))
ants_raw
```
```{r}
ants_data_wrangled <- ants_raw %>% 
  pivot_longer(names_to="species",values_to="abundance",matches("[:upper:].+\\.[:lower:].+", ignore.case = FALSE)) %>% 
  select("year", "species", "abundance")
ants_data_wrangled
```

```{r}
ants_data_wrangled %>% 
  mutate(species = str_replace(species, "C....+\\.line.+","Cremline")) %>% 
  mutate(species = str_replace(species,"H....+\\.opac.+", "Hypoopac")) %>% 
  mutate(species = str_replace(species, "N....+\\.opac.+", "Neivopac")) %>% 
  mutate(species = str_replace(species, "S....+\\.loui.+", "Struloui")) %>% 
```

